<div class="time-widget-wrap" style="cursor: pointer;">
  <a class="time-widget" style="
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.2em;
    padding: 0 4px;
    white-space: nowrap;
    user-select: none;
  ">
    <span>🕒</span>
    <span id="custom-clock" style="font-size: 1.1em; letter-spacing: 0.1em; font-weight: bold;"></span>
  </a>
</div>

<script>
  const digitalClock = document.getElementById('custom-clock');
  const widgetWrap = document.querySelector('.time-widget-wrap');
  let collapsed = false;

  function updateTime() {
    const now = new Date();
    const h = now.getHours().toString().padStart(2, '0');
    const m = now.getMinutes().toString().padStart(2, '0');
    const s = now.getSeconds().toString().padStart(2, '0');
    digitalClock.textContent = `${h}:${m}:${s}`;
    digitalClock.classList.add('update');
    setTimeout(() => digitalClock.classList.remove('update'), 300);
  }

  updateTime();
  setInterval(updateTime, 1000);

  widgetWrap.addEventListener('click', e => {
    e.stopPropagation();
    collapsed = !collapsed;
    toggleStates(collapsed);
  });

  document.addEventListener('click', () => {
    if (collapsed) {
      collapsed = false;
      toggleStates(collapsed);
    }
  });

  function toggleStates(collapse) {
    collapsed = collapse; // 更新状态

    // 控制 main-inner
    const mainInner = document.querySelector('.main-inner');
    if (mainInner) {
      mainInner.style.transition = 'transform 0.5s ease';
      mainInner.style.transform = collapse ? 'translateY(-100%)' : 'translateY(0)';
      mainInner.style.pointerEvents = collapse ? 'none' : 'auto';
    }

    // 控制 clock-container 平移
    const clockContainer = document.querySelector('.clock-container');
    if (clockContainer) {
      clockContainer.style.transition = 'right 0.5s ease';
      clockContainer.style.right = collapse ? '10%' : '-30%';
      clockContainer.style.zIndex = collapse ? '0' : '-2';
    }

    // 控制时间显示
    const overlay = document.getElementById('clock-time-overlay');
    if (!overlay) return;

    if (collapse) {
      const now = new Date();
      const hh = String(now.getHours()).padStart(2, '0');
      const mm = String(now.getMinutes()).padStart(2, '0');
      overlay.textContent = `${hh}:${mm}`;
      overlay.classList.add('show');
    } else {
      overlay.classList.remove('show');
    }
  }


</script>

